# Определение музыкальной композиции по произвольному отрезку аудио длинной 2.5 с

Colab: https://colab.research.google.com/drive/1nX3MmjrS4ymjuVbQk-EkaFNEO_J9SG3f?usp=sharing
 
** Принцип работы **

Спектрограмма (частотно-временная зависимость с учётом амплитуды звукового сигнала) - уникальна для каждого музыкального произведения и как отпечаток пальцев - позволяет идентифицироать музыкальную композицию.

Нам известно, что любой сигнал может быть разложен в ряд Фурье и представлен набором синусоид с определённым фазовым сдвигом, частотой и амплитудой.

На основании ряда Фурье можно построить хромограмму (спектрограмма, апроксимированная по наборам значений за определённый, очень короткий промежуток времени). Таким образом хромограмма, как и спектрограмма - уникальна для каждого музыкального трека.

Хромограмма является тензором второго ранга, если мы добавим третью ось, мы получим трёхмерный тензор, где на осями являются частота (Y) и время (X), а значением (3-я ось) является амплитуда сигнала в данной точке.

Как видим, по своей структуре данный тензор очень похож на тензор изображения, а поэтому для обработки логично применить к нему свёрточную нейронную сеть.

Музыкальную композицию можно разбить на скользящие окна, продолжительностью 1 * 100/(22050/512) ~= 2,322 секунды,

где 22050 - частота дискретизации, берётся значение 0.5 от стандартной частоты в 44100 Гц.
512 - выборка для отдельного участка спектрограммы
100 - длинна окна (в количестве выборок)
1 - шаг смещения окна
Хромограммы перекрывают друг друга и отстоят на очень небольшое расстояни - 0,0232 секунды. За это время музыкальная композиция практически не меняется.

Взяв произвольный отрезок тестовой композиции длинной свыше 2,322 секунды - мы можем вырезать из тестовой композиции фрагмент, равный длинне нашего окна и сравнить его с образцом с помощью сврточной нейронной сети.